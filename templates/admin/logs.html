{% extends "base.html" %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-6">View Logs</h1>
    <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
        <div class="mb-4">
            <label for="log-level" class="block text-gray-700 text-sm font-bold mb-2">Log Level</label>
            <select id="log-level" class="shadow border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                <option value="all">All</option>
                <option value="info">Info</option>
                <option value="warning">Warning</option>
                <option value="error">Error</option>
            </select>
        </div>
        <div class="mb-4">
            <label for="date-range" class="block text-gray-700 text-sm font-bold mb-2">Date Range</label>
            <input type="date" id="start-date" class="shadow border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mr-2">
            <input type="date" id="end-date" class="shadow border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
        </div>
        <button onclick="fetchLogs()" class="btn btn-blue">Fetch Logs</button>
    </div>
    <div id="logs-container" class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
        <pre id="logs-content" class="whitespace-pre-wrap"></pre>
    </div>
</div>

<script>
function fetchLogs() {
    const logLevel = document.getElementById('log-level').value;
    const startDate = document.getElementById('start-date').value;
    const endDate = document.getElementById('end-date').value;

    fetch(`/admin/fetch_logs?level=${logLevel}&start_date=${startDate}&end_date=${endDate}`)
        .then(response => response.json())
        .then(data => {
            const logsContent = document.getElementById('logs-content');
            logsContent.textContent = data.logs.join('\n');
        })
        .catch(error => {
            console.error('Error fetching logs:', error);
            alert('An error occurred while fetching logs.');
        });
}
</script>
{% endblock %}
